namespace = ps

# ps.1: Spawn Planet States
event = {
	id = ps.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_system = {
			limit = {
				NOR = {
					is_fe_cluster = yes
					has_star_flag = empire_home_system
					has_star_flag = empire_cluster
					has_star_flag = enclave
					has_star_flag = guardian
					has_star_flag = hostile_system
					has_star_flag = marauder_system
					has_star_flag = caravaneer_home
				}
				any_system_planet = {
					uninhabitable_regular_planet = yes
				}
			}

			random_system_planet = {
				limit = { uninhabitable_regular_planet = yes }

				# Set Planet Size and Class
				set_planet_size = 24
				change_pc = pc_city

				# Create Species, Country and Fleet
				create_species = {
					name = random
					class = random_non_machine
					portrait = random
					traits = random
				}
				create_country = {
					name = "PLANET STATE"
					type = planet_state
					authority = "auth_democratic"
					civics = random
					species = last_created
					flag = random
					ethos = {
						ethic = ethic_fanatic_egalitarian
					}
					ignore_initial_colony_error = yes
				}
				last_created_country = {
					save_event_target_as = first_planet_state
					set_graphical_culture = mammalian_01
					create_fleet = {
						name = "NAME_Ars_Artem"
						settings = { spawn_debris = no }
						effect = {
							set_owner = prev
							create_ship = {
								name = random
								design = "NAME_Artist_Enclave_Station"
								graphical_culture = prev
							}
							set_location = {
								target = prevprev
								angle = random
								distance = 15
							}
						}
					}
					create_leader = {
						class = ruler
						species = prev
						name = random
						skill = 5
					}
					set_leader = last_created_leader
				}

				# Set Planet State as Owner of the planet
				set_owner = event_target:first_planet_state
				set_controller = event_target:first_planet_state
				set_capital = yes

				# Add Builings, Districts, Pops
				add_building = building_system_capital
				add_building = building_hall_judgment
				add_building = building_hydroponics_farm
				add_building = building_hydroponics_farm
				add_building = building_food_processing_facility
				add_building = building_energy_grid
				add_building = building_institute
				add_building = building_commercial_megaplex
				add_building = building_commercial_megaplex
				add_building = building_galactic_stock_exchange
				add_building = building_paradise_dome
				add_building = building_hyper_entertainment_forum
				add_building = building_autocurating_vault
				add_building = building_fortress
				add_building = building_planetary_shield_generator
				while = {
					count = 14
					add_district = district_arcology_housing
				}
				while = {
					count = 4
					add_district = district_arcology_civilian_industry
				}
				while = {
					count = 6
					add_district = district_arcology_leisure
				}
				while = {
					count = 200
					create_pop = {
						species = owner_main_species
					}
				}

			}
		}
	}
}
